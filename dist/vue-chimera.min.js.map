{"version":3,"file":"vue-chimera.min.js","sources":["../src/utils.js","../node_modules/p-debounce/index.js","../src/Resource.js","../src/NullResource.js","../src/VueChimera.js","../src/mixin.js","../src/index.js","../src/NuxtPlugin.js"],"sourcesContent":["import Axios from 'axios'\n\nexport function isPlainObject (value) {\n  const OBJECT_STRING = '[object Object]'\n  return typeof value === 'object' && Object.prototype.toString(value) === OBJECT_STRING\n}\n\nexport function remove (arr, item) {\n  if (arr.length) {\n    const index = arr.indexOf(item)\n    if (index > -1) {\n      return arr.splice(index, 1)\n    }\n  }\n}\n\nexport function mergeExistingKeys (...obj) {\n  let o = Object.assign(...obj)\n  return Object.keys(obj[0]).reduce((carry, item) => {\n    carry[item] = o[item]\n    return carry\n  }, {})\n}\n\nexport function createAxios (config) {\n  if (config instanceof Axios) {\n    return config\n  }\n  // Support nuxt axios\n  if (config && typeof config.$request === 'function') {\n    return config\n  }\n  if (isPlainObject(config)) {\n    return Axios.create(config)\n  }\n  if (typeof config === 'function') {\n    if (typeof config.request === 'function') return config\n    let axios = config()\n    if (axios instanceof Axios) return axios\n  }\n  return Axios\n}\n\nexport function noop () {}\n\nexport function noopReturn (arg) { return arg }\n","'use strict';\nmodule.exports = (fn, wait, opts) => {\n\tif (!Number.isFinite(wait)) {\n\t\tthrow new TypeError('Expected `wait` to be a finite number');\n\t}\n\n\topts = opts || {};\n\n\tlet leadingVal;\n\tlet timer;\n\tlet resolveList = [];\n\n\treturn function () {\n\t\tconst ctx = this;\n\t\tconst args = arguments;\n\n\t\treturn new Promise(resolve => {\n\t\t\tconst runImmediately = opts.leading && !timer;\n\n\t\t\tclearTimeout(timer);\n\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\ttimer = null;\n\n\t\t\t\tconst res = opts.leading ? leadingVal : fn.apply(ctx, args);\n\n\t\t\t\tfor (resolve of resolveList) {\n\t\t\t\t\tresolve(res);\n\t\t\t\t}\n\n\t\t\t\tresolveList = [];\n\t\t\t}, wait);\n\n\t\t\tif (runImmediately) {\n\t\t\t\tleadingVal = fn.apply(ctx, args);\n\t\t\t\tresolve(leadingVal);\n\t\t\t} else {\n\t\t\t\tresolveList.push(resolve);\n\t\t\t}\n\t\t});\n\t};\n};\n","import Axios from 'axios'\nimport Vue from 'vue'\nimport { isPlainObject, mergeExistingKeys, noopReturn } from './utils'\nimport pDebounce from 'p-debounce'\nconst { CancelToken } = Axios\n\nexport const EVENT_SUCCESS = 'success'\nexport const EVENT_ERROR = 'error'\nexport const EVENT_CANCEL = 'cancel'\nexport const EVENT_LOADING = 'loading'\nexport const EVENT_TIMEOUT = 'timeout'\n\nexport default class Resource {\n  constructor (options, initial) {\n    if (typeof options === 'string') options = { url: options }\n\n    let {\n      autoFetch,\n      prefetch,\n      cache,\n      debounce,\n      transformer,\n      axios,\n      key,\n      interval,\n      ...requestConfig\n    } = options\n\n    requestConfig.method = (requestConfig.method || 'get').toLowerCase()\n\n    if (typeof autoFetch === 'string') {\n      this.autoFetch = autoFetch.toLowerCase() === requestConfig.method\n    } else {\n      this.autoFetch = Boolean(prefetch)\n    }\n\n    this.key = key\n    this.prefetch = typeof prefetch === 'boolean' ? prefetch : this.autoFetch\n    this.cache = cache\n    this.axios = axios\n    this.fetchDebounced = pDebounce(this.fetch.bind(this), debounce, { leading: true })\n    this._interval = interval\n\n    // Set Transformers\n    this.setTransformer(transformer)\n\n    if (requestConfig.data) {\n      console.warn('[Chimera]: Do not use \"params\" key inside resource options, use data instead')\n    }\n    if ('params' in options && !isPlainObject(options.params)) {\n      throw new Error('[Chimera]: Parameters is not a plain object')\n    }\n    if (requestConfig.method !== 'get') {\n      requestConfig.data = requestConfig.params\n      delete requestConfig.params\n    }\n\n    this.requestConfig = {\n      ...requestConfig,\n      cancelToken: new CancelToken(c => {\n        this._canceler = c\n      })\n    }\n\n    this._listeners = {}\n    this.prefetched = false\n\n    // Set Events\n    if (isPlainObject(options.on)) {\n      for (let key in options.on) {\n        this.on(key, options.on[key])\n      }\n    }\n\n    this.setInitial(initial)\n  }\n\n  setTransformer (transformer) {\n    if (typeof transformer === 'function') {\n      this.responseTransformer = transformer\n      this.errorTransformer = transformer\n    } else if (isPlainObject('object')) {\n      const { response, error } = transformer\n      this.responseTransformer = response || noopReturn\n      this.errorTransformer = error || noopReturn\n    } else {\n      this.responseTransformer = noopReturn\n      this.errorTransformer = noopReturn\n    }\n  }\n\n  setInitial (data) {\n    Object.assign(this, mergeExistingKeys({\n      loading: false,\n      status: null,\n      data: null,\n      headers: null,\n      error: null,\n      lastLoaded: null\n    }, data || {}))\n  }\n\n  on (event, handler) {\n    let listeners = this._listeners[event] || []\n    listeners.push(handler)\n    this._listeners[event] = listeners\n    return this\n  }\n\n  emit (event) {\n    (this._listeners[event] || []).forEach(handler => {\n      handler(this, event)\n    })\n  }\n\n  fetch (force, extraParams, extraOptions) {\n    return new Promise((resolve, reject) => {\n\n      if (this.cache && !force) {\n        let cacheValue = this.getCache()\n        if (cacheValue) {\n          this.setByResponse(cacheValue)\n          return resolve(cacheValue)\n        }\n      }\n\n      this.loading = true\n      this.emit(EVENT_LOADING)\n\n      // Merge extra options\n      let { requestConfig } = this\n      if (isPlainObject(extraOptions)) {\n        requestConfig = Object.assign({}, requestConfig, isPlainObject(extraOptions) ? {} : {})\n      }\n      // Merge extra params\n      if (isPlainObject(extraParams)) {\n        const paramKey = requestConfig.method === 'get' ? 'params' : 'data'\n        requestConfig[paramKey] = Object.assign(requestConfig[paramKey], extraParams)\n      }\n\n      // Finally make request\n      this.axios.request(requestConfig).then(res => {\n        this.setByResponse(res)\n        this.setCache(res)\n        this.emit(EVENT_SUCCESS)\n        resolve(res)\n      }).catch(err => {\n        this.setByResponse(err.response)\n        if (Axios.isCancel(err)) {\n          this.emit(EVENT_CANCEL)\n        } else if (err.message && !err.response && err.message.indexOf('timeout') !== -1) {\n          this.emit(EVENT_TIMEOUT)\n        } else {\n          this.emit(EVENT_ERROR)\n        }\n\n        reject(err)\n      }).finally(() => {\n        this.loading = false\n      })\n    })\n  }\n\n  reload (force) {\n    return this.fetchDebounced(force)\n  }\n\n  send (params, options) {\n    return this.fetchDebounced(true, params, options)\n  }\n\n  cancel (unload) {\n    if (unload) this.data = null\n    if (typeof this._canceler === 'function') this._canceler()\n    this.requestConfig.cancelToken = new CancelToken(c => { this._canceler = c })\n  }\n\n  getCacheKey () {\n    if (this.key) return this.key\n    return (typeof window !== 'undefined' && typeof btoa !== 'undefined'\n      ? window.btoa\n      : x => x)(this.requestConfig.url +\n      this.requestConfig.params +\n      this.requestConfig.data +\n      this.requestConfig.method)\n  }\n\n  getCache () {\n    return this.cache ? this.cache.getItem(this.getCacheKey()) : undefined\n  }\n\n  setCache (value) {\n    this.cache && this.cache.setItem(this.getCacheKey(), value)\n  }\n\n  deleteCache () {\n    this.cache && this.cache.removeItem(this.getCacheKey())\n  }\n\n  setByResponse (res) {\n    res = res || {}\n    const isSuccessful = String(res.status).charAt(0) === '2'\n    this.status = res.status\n    this.headers = res.headers || {}\n    this.lastLoaded = new Date()\n    this.data = isSuccessful ? this.responseTransformer(res.data, this) : null\n    this.error = !isSuccessful ? this.errorTransformer(res.data, this) : null\n  }\n\n  startInterval (ms) {\n    if (typeof ms !== 'number') throw new Error('[Chimera]: interval should be number')\n    if (typeof process !== 'undefined' && process.server) return\n\n    this._interval = ms\n    this.stopInterval()\n    this._interval_id = setInterval(() => this.reload(true), this._interval)\n    this.looping = true\n  }\n\n  stopInterval () {\n    if (this._interval_id) {\n      clearInterval(this._interval_id)\n      this.looping = false\n      this._interval_id = null\n      this._interval = false\n    }\n  }\n\n  toObj () {\n    const json = {};\n    ['loading', 'status', 'data', 'headers', 'error', 'lastLoaded', 'prefetched'].forEach(key => {\n      json[key] = this[key]\n    })\n    return json\n  }\n\n  toString () {\n    return JSON.stringify(this.toObj())\n  }\n}\n","import Resource from './Resource'\n\nexport default class NullResource extends Resource {\n  fetch (force) {\n    return Promise.reject(new Error('Null Resource'))\n  }\n\n  cancel () {}\n}\n","import Vue from 'vue'\nimport Resource from './Resource'\nimport NullResource from './NullResource'\nimport { createAxios } from './utils'\n\n// Start intervals, unregister events, prefetch\nexport default class VueChimera {\n  constructor (vm, resources, { ...options }) {\n    this._vm = vm\n    this._watchers = []\n\n    this._axios = options.axios = createAxios(options.axios)\n    this._options = options\n    this._resources = resources\n    // this._vm.$on('hook:created', this.init)\n  }\n\n  init () {\n    const resources = this._resources = Object.assign({}, this._resources)\n    for (let key in resources) {\n      if (key.charAt(0) === '$') continue\n\n      let r = resources[key]\n      if (typeof r === 'function') {\n        this._watchers.push(this._vm.$watch(() => r.call(this._vm), (t, f) => this.updateResource(key, t, f), {\n          immediate: true,\n          deep: true\n        }))\n      } else {\n        resources[key] = this.resourceFrom(r, key)\n      }\n      Object.defineProperty(this._vm, key, {\n        get: () => resources[key],\n        configurable: true,\n        enumerable: true\n      })\n    }\n\n    Object.defineProperty(resources, '$cancelAll', { value: this.cancelAll.bind(this) })\n    Object.defineProperty(resources, '$axios', { get: () => this._axios })\n    Object.defineProperty(resources, '$loading', { get () { return !!Object.values(this).find(Boolean) } })\n  }\n\n  updateResource (key, newValue, oldValue) {\n    const oldResource = this._resources[key]\n    const newResource = this.resourceFrom(newValue, key)\n\n    // Keep data\n    if (oldValue && oldValue.keepData) {\n      newResource.setInitial(oldResource)\n    }\n    if (oldValue && oldResource) {\n      oldResource.stopInterval()\n      newResource.lastLoaded = oldResource.lastLoaded\n    }\n\n    if (newResource.prefetch) newResource.reload()\n    this._resources[key] = newResource\n  }\n\n  resourceFrom (value, key) {\n    if (value == null) return new NullResource()\n    if (typeof value === 'string') value = { url: value }\n\n    return new Resource(Object.assign(Object.create(this._options), value))\n  }\n\n  cancelAll () {\n    Object.values(this._resources).forEach(r => {\n      r.cancel()\n    })\n  }\n\n  destroy () {\n    const vm = this._vm\n\n    this.cancelAll()\n    delete vm._chimera\n  }\n}\n","import VueChimera from './VueChimera'\nimport { isPlainObject } from './utils'\n\nexport default (options = {}) => ({\n  beforeCreate () {\n    const vmOptions = this.$options\n    let _chimera\n\n    // Stop if instance doesn't have chimera or already initialized\n    if (!vmOptions.chimera || vmOptions._chimera) return\n\n    if (typeof vmOptions.chimera === 'function') {\n      // Initialize with function\n      vmOptions.chimera = vmOptions.chimera.call(this)\n    }\n\n    if (vmOptions.chimera instanceof VueChimera) {\n      _chimera = vmOptions.chimera\n    } else if (isPlainObject(vmOptions.chimera)) {\n      const { $options, ...resources } = vmOptions.chimera\n      _chimera = new VueChimera(this, resources, { ...options, ...$options })\n    }\n\n    // Nuxtjs prefetch\n    const NUXT = typeof process !== 'undefined' && process.server && this.$ssrContext\n      ? this.$ssrContext.nuxt\n      : (typeof window !== 'undefined' ? window.__NUXT__ : null)\n    if (_chimera && NUXT && NUXT.chimera) {\n      try {\n        if (this.$router) {\n          let matched = this.$router.match(this.$router.currentRoute.fullPath);\n          (matched ? matched.matched : []).forEach((m, i) => {\n            let nuxtChimera = NUXT.chimera[i]\n            if (nuxtChimera) {\n              Object.keys(_chimera.resources).forEach(key => {\n                let localResource = _chimera.resources[key]\n                let ssrResource = nuxtChimera[key]\n                if (localResource && ssrResource && ssrResource._data) {\n                  [\n                    '_data', '_status', '_headers', 'ssrPrefetched',\n                    '_lastLoaded'].forEach(key => {\n                    localResource[key] = ssrResource[key]\n                  })\n                }\n              })\n            }\n          })\n          // if (process.client) {\n          //   delete NUXT.chimera\n          // }\n        }\n      } catch (e) {}\n    }\n    this._chimera = _chimera\n  },\n\n  data () {\n    return {\n      $chimera: this._chimera ? this._chimera._resources : null\n    }\n  },\n\n  created () {\n    if (!this._chimera) return\n    this._chimera.init()\n  }\n\n  // mounted () {\n  //   if (this._chimera) {\n  //     this._chimera.updateReactiveResources()\n  //     for (let r in this._chimera.resources) {\n  //       let resource = this._chimera.resources[r]\n  //       if (resource.prefetch && (!resource.ssrPrefetched || resource.ssrPrefetch === 'override')) {\n  //         resource.reload()\n  //       }\n  //     }\n  //   }\n  // },\n})\n","import mixin from './mixin'\nimport NuxtPlugin from './NuxtPlugin'\n\nconst plugin = {\n\n  options: {\n    axios: null,\n    cache: null,\n    debounce: 50,\n    autoFetch: 'get', // false, true, '%METHOD%',\n    prefetch: null,\n    prefetchTimeout: 4000,\n    transformer: null\n  },\n\n  install (Vue, options = {}) {\n    Object.keys(options).forEach(key => {\n      if (key in this.options) {\n        this.options[key] = options[key]\n      }\n    })\n\n    if (!Vue.prototype.hasOwnProperty('$chimera')) {\n      Object.defineProperty(Vue.prototype, '$chimera', {\n        get () {\n          return this._chimera ? this._chimera._resources : null\n        }\n      })\n    }\n\n    Vue.mixin(mixin(this.options))\n  },\n\n  NuxtPlugin\n\n}\n\n// Auto-install\nlet GlobalVue = null\nif (typeof window !== 'undefined') {\n  GlobalVue = window.Vue\n} else if (typeof global !== 'undefined') {\n  GlobalVue = global.Vue\n}\n\nif (GlobalVue) {\n  GlobalVue.use(plugin, plugin.options)\n}\n\nexport default plugin\n\nexport * from './Resource'\n","import Resource from './Resource'\n\nexport default function () {\n  this.options = this.options || {}\n  const baseOptions = this.options\n\n  return function ({ beforeNuxtRender, isDev, $axios }) {\n    if (!beforeNuxtRender) { return }\n\n    const cancelTokens = []\n    async function prefetchAsyncData ({ Components, nuxtState }) {\n      nuxtState.chimera = nuxtState.chimera || {}\n\n      for (let i = 0, len = Components.length; i < len; i++) {\n        let component = Components[i]\n        let chimera = component.options ? component.options.chimera : null\n\n        if (typeof chimera === 'function') {\n          // Append @Nuxtjs/axios to component (maybe needed by constructor)\n          if ($axios && !component.$axios) component.$axios = $axios\n          chimera = chimera.bind(component)()\n        }\n\n        if (!chimera) { continue }\n\n        const nuxtChimera = {}\n        const { $options, ...resources } = chimera\n        const options = Object.assign({}, baseOptions, $options)\n        if (!options.axios) options.axios = $axios\n\n        for (let key in resources) {\n          let resource = resources[key]\n          if (resource && typeof resource !== 'function') {\n            resource = resource && resource._data ? resource : Resource.from(resource, options)\n            cancelTokens.push(resource.cancel.bind(resource))\n            if (!resource.prefetch || !resource.ssrPrefetch) continue\n            try {\n              isDev && console.log('  Prefetching: ' + resource.requestConfig.url) // eslint-disable-line no-console\n              let response = await resource.execute()\n              resource._data = response.data\n            } catch (err) {\n              isDev && console.error(err.message) // eslint-disable-line no-console\n            }\n            resource.ssrPrefetched = true\n            resources[key] = nuxtChimera[key] = resource\n          }\n        }\n        if (Object.keys(nuxtChimera).length) {\n          nuxtState.chimera[i] = nuxtChimera\n        }\n      }\n    }\n\n    beforeNuxtRender((...args) => {\n      return new Promise((resolve, reject) => {\n        prefetchAsyncData(...args).then(resolve).catch(reject)\n        setTimeout(reject, baseOptions.ssrPrefetchTimeout, new Error('  SSR Prefetch Timeout.'))\n      }).catch(err => {\n        for (let cancel of cancelTokens) if (typeof cancel === 'function') cancel()\n        isDev && console.error(err.message) // eslint-disable-line no-console\n      })\n    })\n  }\n}\n"],"names":["isPlainObject","value","Object","prototype","toString","noopReturn","arg","fn","wait","opts","Number","isFinite","TypeError","leadingVal","timer","resolveList","ctx","this","args","arguments","Promise","resolve","runImmediately","leading","clearTimeout","setTimeout","res","apply","push","CancelToken","Axios","EVENT_SUCCESS","EVENT_ERROR","EVENT_CANCEL","EVENT_LOADING","EVENT_TIMEOUT","Resource","constructor","options","initial","url","autoFetch","prefetch","cache","debounce","transformer","axios","key","interval","requestConfig","method","toLowerCase","Boolean","fetchDebounced","pDebounce","fetch","bind","_interval","setTransformer","data","console","warn","params","Error","cancelToken","c","_canceler","_listeners","prefetched","on","setInitial","responseTransformer","errorTransformer","response","error","assign","obj","o","keys","reduce","carry","item","mergeExistingKeys","loading","status","headers","lastLoaded","event","handler","listeners","emit","forEach","force","extraParams","extraOptions","reject","cacheValue","getCache","setByResponse","paramKey","request","then","setCache","catch","err","isCancel","message","indexOf","finally","reload","send","cancel","unload","getCacheKey","window","btoa","x","getItem","undefined","setItem","deleteCache","removeItem","isSuccessful","String","charAt","Date","startInterval","ms","process","server","stopInterval","_interval_id","setInterval","looping","clearInterval","toObj","json","JSON","stringify","NullResource","VueChimera","vm","resources","_vm","_watchers","_axios","config","$request","create","createAxios","_options","_resources","init","r","$watch","call","t","f","updateResource","immediate","deep","resourceFrom","defineProperty","get","configurable","enumerable","cancelAll","values","find","newValue","oldValue","oldResource","newResource","keepData","destroy","_chimera","beforeCreate","vmOptions","$options","chimera","NUXT","$ssrContext","nuxt","__NUXT__","$router","matched","match","currentRoute","fullPath","m","i","nuxtChimera","localResource","ssrResource","_data","e","$chimera","created","plugin","prefetchTimeout","install","Vue","hasOwnProperty","mixin","NuxtPlugin","baseOptions","beforeNuxtRender","isDev","$axios","cancelTokens","Components","nuxtState","len","length","component","resource","from","ssrPrefetch","log","execute","ssrPrefetched","prefetchAsyncData","ssrPrefetchTimeout","GlobalVue","global","use"],"mappings":"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"}